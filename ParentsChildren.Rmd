---
title: 'BA1820: Group Project'
author: "Team 3"
date: ''
output:
  html_document: default
  pdf_document: default
---

Team discussion on 11 Oct 2016:  
  
* Intro  
* Description of the dataset of the variables that you used.  
    + how many participants, where are they. age range  
    + how many questions asked.  
* Describe the global cleaning - how many records we lost.  
  
* 3 sections overview  
  
* Each section  
    + Intro and hypothesis  
    + Which questions you looked at  
    + Findings  
    + Limitations  
    + Conclusion  
    + Improvements we could to do in future if we had more time..  
  
* Final conclusion  


```{r, echo = FALSE, message = FALSE, include = FALSE}
#Relationship between parents and children (Kelvin/Bilal)

# ==========================
# Kelvin's beta code (START)
# ==========================

# Load globally cleaned data file
load("cleaned_data.Rdata")
# the data frame variable, survey_data, will be loaded into the environment.

# load needed libraries
library(ggplot2)
library(stargazer)
```


***

## Introduction

The dataset had a number of questions there were posed to the teen's parent, and a number of similar questions posed to the teen.  
  
A number of hypotheses were investigated using this dataset, to see if there were any relationships between parent's behaviours and the teen's behaviours using social media.  
  
For example, parents were asked if they monitor their child's location (could be considered as a form of stalking behaviour), and whether the teen monitored someone they were dating or had dated (similar stalking behaviour). This was an opportunity to investigate if teens were more likely to exhibit stalking behaviour if their parent did the same too.  
  
There were also questions on whether the parent blocks their child's phone usage and whether the child sends sexy/flirty messages. One of the hypotheses was thus whether the child would send more likely sexy/flirty messages, if the parent blocks their child's phone usage, which could suggest that the parent's intervention might have triggered a rebellious behaviour (e.g. the stricter the parent, the more the child wants to be liberal).    

<b>Methodology</b>  
  
As the dependent variable for each investigation was a categorical variable (being responses of a survey question), logistic regression was used. Linear regression would not make sense as the coefficient of linear regression would not translate to anything meaningful.  Dependent variables where the possible responses were "No" or "Yes", i.e. binary 0 or 1 response, were chosen for analysis.    
  
The function <i>glm</i> was used, <i>model <- glm(y ~ x1 + x2 + .. + xk, data = dataframe, family = "binomial").</i>    
  
In most cases, the independent variables were also survey responses that could have more than 2 options. e.g. 1.Yes, a lot, 2.Yes, a little, 3.No.  Researching literature online, there were two possible approaches: (1) leave such variables as numeric (R would interpret them as continuous variables), or convert them as factors (R would interpret them as categorical variables, and regression would yield a coefficient for each possible option). Setting these variables as continuous variables might be contentious as the value of the variables were discrete in nature, and it might be difficult to explain why optioni 1 had value 1, and not 2 or 50 etc. Hence on balance, these variables were converted to factor, even though this would increase the total number of variables used in the regression and inflate the R<sup>2</sup> value (AIC value for logistic regression).  All dependent and independent variables were reordered so that the higher the value, the higher the scale of the response. i.e. instead of 1 for Yes and 2 for No, we reordered it to 0 for No and 1 for Yes.          

<font color = red> Bilal: help to put in explanations on how to interpret the coefficients, and exp function. thanks!</font>
  
The 6 questions, their corresponding hypotheses, and their associated findings are summarised in the section below.  
  
***

## Executive summary of findings:
  
  
<u>Effects of Parent and child behaviour, on teen's use of social media</u>

The table below summarises the questions studied, the initial hypothesis, and findings from the data.  
  
Question                               |  Hypothesis   |  Findings
-------------------------------------  |  ------------------------------------- | -------------------------------------
1. Relationship between parents blocking their child’s phone usage and their child’s online behaviour on sexy/flirty pictures   |  If teens are rebellious, then the stricter the parent, the more the child wants to be liberal and may be more inclined to send flirty pictures | The regression results suggest that if parents took away their child’s cell phone or internet privileges as punishment, the teen is 169% more likely to send sexy or flirty pictures or videos of themselves. There is no statistically significant effect of other parent's strict behaviours: parent using parental controls to restrict child’s use of his/her cell phone, and limiting the amount of time or times of day when child can go online   
2.	Relationship on whether children self-censor their posts if they are friends with parents on social media   |   Teens’ whose parents are friends with them on social media will likely not post details of their relationship online  | There was no statiscally significant evidence to show that whether the parent was connected to their child on social media had an impact on child posting public affection for their significant other (proxy of whether child self-censors their posts). Upon adding more variables to the regression, the regression suggests that teens feeling pressure to only post content that makes them look good to others, were around 90% ("Yes, a little pressure") to 214% ("Yes, a lot pressure") more likely to post public affection towards his/her significant other. There is no significant statistical evidence to show that various teen's parent's behaviours (connecting with child on social media, being friends on Facebook, and checking child's social media profile) have an effect on teen's public affection behaviour.  This seems to suggest that teens are more influenced by their self-perception, rather than their parent's interventions, with respect to whether or not they post public affection towards his/her significant other.     
3.	Relationship between stalking behaviour of parent to child and stalking behaviour of child to his/her boyfriend/girlfriend |  If parents stalk teen, teen is more likely to inherit the stalking behaviour and stalk his/her boyfriend/girlfriend | It seemed that if parent monitors their child's location (parent's stalking behaviour), teens are around 190% more likely (at 90% confidence level) to access the phone of someone they were dating or used to date (child's stalking behaviour).  It seemed that if parent monitors their child's location (parent's stalking behaviour), teens are around 567% more likely (at 90% confidence level) to track the location of someone they were dating or used to date (child's stalking behaviour).  In both cases, parent monitoring child's location seemed correlated with both child's stalking behaviours (accessing phone and tracking GPS location).      

***
## Details of the questions investigated, and findings
  
### Question 1  
 
Question: Relationship between parents blocking their child’s phone usage and their child’s online behaviour on sexy/flirty pictures   
  
*Hypothesis: The stricter the parent, the more the child wants to be liberal.*  
  
<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variable]*:  
KDATE2_G: Have you ever done any of these things to let someone know you were attracted to them or interested in them? Have you sent them sexy or flirty pictures or videos of yourself?  
1.Yes  
2.No  
  
*[Independent variables]*:  
P14_F: Have you ever used parental controls to restrict your child's use of his/her cell phone?  
1.Yes  
2.No  
3.Does Not Apply  

P13_D: Have you ever taken away your child's cell phone or internet privileges as punishment?  
1.Yes  
2.No  
3.Does Not Apply  

P13_E: Have you ever limited the amount of time or times of day when your child can go online?    
1.Yes  
2.No  
3.Does Not Apply  

<b> Data cleaning </b>  
  
Rows with invalid responses were removed by filling them with NA (e.g. if respondents were supposed to choose only options 1 or 2, but the data showed 3 or -1, these would be invalid responses).    
  
The order of the options were reversed, so that the higher number represents the "most" choice, and 0 for No or None. E.g. for if the question's original order of choices that respondents could choose from were:  
  1.Yes,  2.No  
The responses' order were re-ordered to:  
  0.No,  1. Yes  
  
For questions with options as Yes/No/Does not apply, for respondents who responded Does not apply, the data record was removed (by filling it with NA), and order No as 0 and Yes as  1.  
  

```{r, echo = FALSE}
data_specific <- data.frame(parent_controls_cell_phone = survey_data$P14_F, take_away_privileges = survey_data$P13_D, limit_time_online = survey_data$P13_E, y = survey_data$KDATE2_G)

# set NA to invalid responses
data_specific[ is.na(data_specific$parent_controls_cell_phone), ] <- NA
data_specific[ is.na(data_specific$take_away_privileges), ] <- NA
data_specific[ is.na(data_specific$limit_time_online), ] <- NA
data_specific[ is.na(data_specific$y), ] <- NA

# Remove data records where respondents replied "Does not apply"
# hence remove those >2 instead of >3
data_specific[ !is.na(data_specific$parent_controls_cell_phone) & (data_specific$parent_controls_cell_phone < 1 | data_specific$parent_controls_cell_phone > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$take_away_privileges) & (data_specific$take_away_privileges < 1 | data_specific$take_away_privileges > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$limit_time_online) & (data_specific$limit_time_online < 1 | data_specific$limit_time_online > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$y) & (data_specific$y < 1 | data_specific$y > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up

# only retain records that replied YES or NO
# convert from 1(YES)-2(NO)-3(does Not Apply)
#           to 0(NO)-1(YES)
data_specific$parent_controls_cell_phone <- abs(data_specific$parent_controls_cell_phone - 3) - 1
data_specific$take_away_privileges <- abs(data_specific$take_away_privileges - 3) - 1
data_specific$limit_time_online <- abs(data_specific$limit_time_online - 3) - 1
# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$y <- abs( data_specific$y - 3 ) - 1

cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])

# convert to factor for regression
data_specific$parent_controls_cell_phone <- factor(data_specific$parent_controls_cell_phone)
data_specific$take_away_privileges <- factor(data_specific$take_away_privileges)
data_specific$limit_time_online <- factor(data_specific$limit_time_online)

data_specific$age <- survey_data$Child_age

```

<b>Findings</b>  
    
The regression between whether teen sends flirty messages, and the strictness of parents: (i) by controlling cell phone, (ii) taking away privileges, (iii) limiting time spent online, and (iv) age, is shown below.    
  
```{r}
ml <- glm(y ~ parent_controls_cell_phone + take_away_privileges + limit_time_online + age, family = "binomial", data = na.omit(data_specific))

summary(ml)

exp(ml$coefficients)


```
  
The take_away_privileges variable is statistically significant with 99% confidence level.  
  
The regression results suggest that if parents took away their child’s cell phone or internet privileges as punishment, the teen is 169% more likely to send sexy or flirty pictures or videos of themselves. There is no statistically significant effect of parent using parental controls to restrict child’s use of his/her cell phone, and limiting the amount of time or times of day when  child can go online.  
  
Given that take_away_privileges was significant, the results suggest that parent's strictness behaviour did affect teen's behaviour on social media.  However, to be more conclusive, more aspects of parental strict behaviour, and more teen's possible rebellious behaviour, could be looked at if time permitted, and if more data was available.  For example, there was a lack of data on other proxies of rebellious behaviour or desire to be more liberal due to strictness of parent, besides sending flirty messages. Perhaps the survey could have included questions on whether the child had found alternative ways to access social media, such as using their friend's internet device or lie to parents that they were in school studying but were actually using a library computer to use social media.  With more data, the investigation could be more comprehensive to determine whether parents being strict had made the situation worse than if parents did not intervene.                 
      
  
***
  
### Question 2  
 
Question:  Relationship on whether children self-censor their posts if they are friends with parents on social media.    
  
*Hypothesis: Teens’ whose parents are friends with them on social media will likely not post details of their relationship online.*  
  
<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variable]*:  
KRSNS3_C: When you use social media do you ever tell your boyfriend, girlfriend or significant other how much you like them in a way that other people can see?  
1.Yes  
2.No  
  
*[Independent variables]*:  
P10: Are you connected with your child on any  social media sites?  
1.Yes  
2.No  
  
Similar data cleaning and manipulation operations were performed to get rid of invalid responses and to re-order values according from least to most.  
  
```{r, echo = FALSE}
data_specific <- data.frame(parent_connect_child = survey_data$P10, teen_public_affection = survey_data$KRSNS3_C)

# set NA to invalid responses
data_specific[ is.na(data_specific$parent_connect_child), ] <- NA
data_specific[ is.na(data_specific$teen_public_affection), ] <- NA

data_specific[ !is.na(data_specific$parent_connect_child) & (data_specific$parent_connect_child < 1 | data_specific$parent_connect_child > 3), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$teen_public_affection) & (data_specific$teen_public_affection < 1 | data_specific$teen_public_affection > 3), ] <- NA  # needs the !is.na condition otherwise an error throws up

# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$parent_connect_child <- abs(data_specific$parent_connect_child - 3) - 1

data_specific$teen_public_affection <- abs(data_specific$teen_public_affection - 3) - 1

cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])

data_specific$age <- survey_data$Child_age


```

<b>Findings</b>  
    
```{r}

cor.test(data_specific$parent_connect_child, data_specific$teen_public_affection)

```

As the p-value is 0.2742, there is no statistically significant evidence to show that the two variables are correlated.


```{r}
# convert to factor for regression
data_specific$parent_connect_child <- factor(data_specific$parent_connect_child)

ml <- glm(teen_public_affection ~ parent_connect_child + age, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

The factor of parent connecting to child is not statistically significant.  
  
Further examination of the data:

```{r}
data_specific$teen_public_affection_factor <- factor(data_specific$teen_public_affection)

ggplot(data = na.omit(data_specific)) + geom_bar(aes(x = parent_connect_child, fill = teen_public_affection_factor), position = "dodge")

```

It seems that when the parent is connected to the child (option 1 / "Yes"), the proportion of teens who express their affection for their significant other publicly, is higher.  

A further a proportion test is done:  

```{r}
prob_table <- table(data_specific$parent_connect_child, data_specific$teen_public_affection)
# inverse the columns, as success is option 2 for teen_public_affection
prob_table <- cbind(prob_table[, 2], prob_table[, 1])
prop.test(prob_table)

```

The p-value = 0.3402, which suggests that there is no statistically significant evidence to show that the two proportions differ.
i.e. similar to the correlation tests, it suggests that the parent social media connection with the child, does not have significant effect on whether the teen shows public affection for significant other on social media.   

Given these intial results, more variables which may relate to the hypothesis, were added to the regression model:  
  
KFSNS1_E: In general, does social media make you feel pressure to only post content that makes you look good to others? 1.Yes, a lot,2.Yes, a little,3.No  
*To test if child's self perception is more strongly correlated to his/her behaviour regarding posting public affection for significant other*

P8:	Are you friends with your child on Facebook? 1.Yes, 2.No  
*To see if parent being friends on Facebook (compared to a more generic social media platform as asked by question P10), is a significant factor*
  
P13_C:  Have you ever checked your child's profile on a social networking site?  1(YES)-2(NO)-3(does Not Apply)  
*To see if parent checking child's profile is a significant factor. Perhaps if the child knows that his/her parent checks his/her profile, he/she will be more restrained in his/her post.*

```{r, echo = FALSE}
data_specific$feel_pressure <- survey_data$KFSNS1_E
data_specific[ is.na(data_specific$feel_pressure), ] <- NA

data_specific[ !is.na(data_specific$feel_pressure) & (data_specific$feel_pressure < 1 | data_specific$feel_pressure > 3), ] <- NA  # needs the !is.na condition otherwise an error throws up
# Change from 1.Yes, a lot,2.Yes, a little,3.No 
#         to 0.No, 1.Yes, a little, 2.Yes, a lot
data_specific$feel_pressure <- abs(data_specific$feel_pressure - 4) - 1 

data_specific$friends_facebook <- survey_data$P8
data_specific[ is.na(data_specific$friends_facebook), ] <- NA

data_specific[ !is.na(data_specific$friends_facebook) & (data_specific$friends_facebook < 1 | data_specific$friends_facebook > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$friends_facebook <- abs(data_specific$friends_facebook - 3) - 1

data_specific$check_child_profile <- survey_data$P13_C
data_specific[ is.na(data_specific$check_child_profile), ] <- NA

# Remove data records where respondents replied "Does not apply"
# hence remove >2 instead of >3
data_specific[ !is.na(data_specific$check_child_profile) & (data_specific$check_child_profile < 1 | data_specific$check_child_profile > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
# only retain records that replied YES or NO
# convert from 1(YES)-2(NO)-3(does Not Apply)
#           to 0(NO)-1(YES)
data_specific$check_child_profile <- abs(data_specific$check_child_profile - 3) - 1 

cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])


data_specific$feel_pressure <- factor(data_specific$feel_pressure)
data_specific$friends_facebook <- factor(data_specific$friends_facebook)
data_specific$check_child_profile <- factor(data_specific$check_child_profile)

```

```{r}
ml <- glm(teen_public_affection ~ parent_connect_child + age + feel_pressure + friends_facebook + check_child_profile, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

The regression suggests that teens feeling pressure to only post content that makes them look good to others, were around 90% ("Yes, a little pressure") to 214% ("Yes, a lot pressure") more likely to post public affection towards his/her significant other. There is no significant statistical evidence to show that various teen's parent's behaviours (connecting with child on social media, being friends on Facebook, and checking child's social media profile) have an effect on teen's public affection behaviour.  

This seems to suggest that teens are more influenced by their self-perception, rather than their parent's interventions, with respect to whether or not they post public affection towards his/her significant other.  
  
***
  
### Question 3  
 
Question:	Relationship between stalking behaviour of parent to child and stalking behaviour of child to his/her boyfriend/girlfriend.   
  
*Hypothesis: If parents stalk teen, teen is more likely to inherit the stalking behaviour and stalk his/her boyfriend/girlfriend*    
  
<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variables]*:  
KR13_C: Have you ever done any of the following to someone you were dating or used to date. Accessed their mobile phone or online accounts     
1.Yes  
2.No  
  
KR13_F: Have you ever done any of the following to someone you were dating or used to date. Downloaded a GPS or tracking program to their cell phone without them knowing      
1.Yes  
2.No  
  

*[Independent variables]*:  
P13_B: Have you ever checked which websites your child visited?   
1.Yes  
2.No  
3.Does Not Apply  
  
P14_G: Have you ever used monitoring tools to track your child's location with his/her cell phone?   
1.Yes  
2.No  
3.Does Not Apply  

P14_H: Have you ever looked at the phone call records or messages on your child's phone?   
1.Yes  
2.No  
3.Does Not Apply  
  
Similar data cleaning and manipulation operations were performed to get rid of invalid responses and to re-order values according from least to most.  
  
```{r, echo = FALSE}
data_specific <- data.frame(
  check_child_website = survey_data$P13_B, 
  monitor_child_location = survey_data$P14_G, 
  look_child_phone_records = survey_data$P14_H, 
  access_date_phone = survey_data$KR13_C, 
  track_date_loc = survey_data$KR13_F  )

# set NA to invalid responses
data_specific[ is.na(data_specific$check_child_website), ] <- NA
data_specific[ is.na(data_specific$monitor_child_location), ] <- NA
data_specific[ is.na(data_specific$look_child_phone_records), ] <- NA
data_specific[ is.na(data_specific$access_date_phone), ] <- NA
data_specific[ is.na(data_specific$track_date_loc), ] <- NA

# Remove data records where respondents replied "Does not apply"
# hence remove >2 instead of >3

data_specific[ !is.na(data_specific$check_child_website) & (data_specific$check_child_website < 1 | data_specific$check_child_website > 2), ] <- NA  

data_specific[ !is.na(data_specific$monitor_child_location) & (data_specific$monitor_child_location < 1 | data_specific$monitor_child_location > 2), ] <- NA  

data_specific[ !is.na(data_specific$look_child_phone_records) & (data_specific$look_child_phone_records < 1 | data_specific$look_child_phone_records > 2), ] <- NA  

data_specific[ !is.na(data_specific$access_date_phone) & (data_specific$access_date_phone < 1 | data_specific$access_date_phone > 2), ] <- NA  

data_specific[ !is.na(data_specific$track_date_loc) & (data_specific$track_date_loc < 1 | data_specific$track_date_loc > 2), ] <- NA  

# only retain records that replied YES or NO
# convert from 1(YES)-2(NO)-3(does Not Apply)
#           to 0(NO)-1(YES)

data_specific$check_child_website <- abs(data_specific$check_child_website - 3) - 1

data_specific$monitor_child_location <- abs(data_specific$monitor_child_location - 3) - 1

data_specific$look_child_phone_records <- abs(data_specific$look_child_phone_records - 3) - 1

# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$access_date_phone <- abs(data_specific$access_date_phone - 3) - 1

data_specific$track_date_loc <- abs(data_specific$track_date_loc - 3) - 1

#data_specific$y <- data_specific$access_date_phone + data_specific$track_date_loc

data_specific$age <- survey_data$Child_age


cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])

```

<b>Findings</b>  
    
```{r, echo = FALSE}
# convert to factor for regression
data_specific$check_child_website <- factor(data_specific$check_child_website)

data_specific$monitor_child_location <- factor(data_specific$monitor_child_location)

data_specific$look_child_phone_records <- factor(data_specific$look_child_phone_records)

data_specific$gender <- factor(survey_data$Child_gender, labels = c('Male','Female'))
```

```{r}
ml <- glm(access_date_phone ~ check_child_website + monitor_child_location + look_child_phone_records + gender + age, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

It seems that if parent monitors their child's location (parent's stalking behaviour), teens are around 190% more likely (at 90% confidence level) to access the phone of someone they were dating or used to date (child's stalking behaviour).   


```{r}
ml <- glm(track_date_loc ~ check_child_website + monitor_child_location + look_child_phone_records + gender + age, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

It seems that if parent monitors their child's location (parent's stalking behaviour), teens are around 567% more likely (at 90% confidence level) to track the location of someone they were dating or used to date (child's stalking behaviour).   
  
In both cases, parent monitoring child's location seemed correlated with both child's stalking behaviours (accessing phone and tracking GPS location).  
  
  
***

## Limitations

The analysis was limited to dependent variables with binary Yes/No oprtions. Ideally, dependent variables with more than 2 options should be considered as well. Perhaps polr function could be used, but there was insufficient time to investigate and understand this further.  

<font color = red>Bilal to add on </font>  
  
***

## Conclusion

<font color = red> Bilal to add on </font>

## Possible future improvements

<font color = red>{ideas on how we can improve the analysis - e.g. if we had more data on blah blah}</font>
