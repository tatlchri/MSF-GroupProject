---
title: 'BA1820: Group Project'
author: "Team 3"
date: ''
output:
  html_document: default
  pdf_document: default
---

Team discussion on 11 Oct 2016:  
  
* Intro  
* Description of the dataset of the variables that you used.  
    + how many participants, where are they. age range  
    + how many questions asked.  
* Describe the global cleaning - how many records we lost.  
  
* 3 sections overview  
  
* Each section  
    + Intro and hypothesis  
    + Which questions you looked at  
    + Findings  
    + Limitations  
    + Conclusion  
    + Improvements we could to do in future if we had more time..  
  
* Final conclusion  


```{r, echo = FALSE, message = FALSE, include = FALSE}
#Relationship between parents and children (Kelvin/Bilal)

# ==========================
# Kelvin's/Bilal's beta code (START)
# ==========================

# Load globally cleaned data file
load("cleaned_data.Rdata")
# the data frame variable, survey_data, will be loaded into the environment.

# load needed libraries
library(ggplot2)
library(stargazer)
library(gridExtra)
library(scales)

```


***

## Introduction

The dataset had a number of questions there were posed to the teen's parent, and a number of similar questions posed to the teen.  
  
A number of hypotheses were investigated using this dataset, to see if there were any relationships between parent's behaviours and the teen's behaviours using social media.  
  
For example, parents were asked if they monitor their child's location (could be considered as a form of stalking behaviour), and whether the teen monitored someone they were dating or had dated (similar stalking behaviour). This was an opportunity to investigate if teens were more likely to exhibit stalking behaviour if their parent did the same too.  
  
There were also questions on whether the parent blocks their child's phone usage and whether the child sends sexy/flirty messages. One of the hypotheses was thus whether the child would send more likely sexy/flirty messages, if the parent blocks their child's phone usage, which could suggest that the parent's intervention might have triggered a rebellious behaviour (e.g. the stricter the parent, the more the child wants to be liberal).    

<b>Methodology</b>  
  
As the dependent variable for each investigation was a categorical variable (being responses of a survey question), logistic regression was used. Linear regression would not make sense as the coefficient of linear regression would not translate to anything meaningful.  Dependent variables where the possible responses were "No" or "Yes", i.e. binary 0 or 1 response, were chosen for analysis.    
  
The function <i>glm</i> was used, <i>model <- glm(y ~ x1 + x2 + .. + xk, data = dataframe, family = "binomial").</i>    
  
In most cases, the independent variables were also survey responses that could have more than 2 options. e.g. 1.Yes, a lot, 2.Yes, a little, 3.No.  Researching literature online, there were two possible approaches: (1) leave such variables as numeric (R would interpret them as continuous variables), or convert them as factors (R would interpret them as categorical variables, and regression would yield a coefficient for each possible option). Setting these variables as continuous variables might be contentious as the value of the variables were discrete in nature, and it might be difficult to explain why optioni 1 had value 1, and not 2 or 50 etc. Hence on balance, these variables were converted to factor, even though this would increase the total number of variables used in the regression and inflate the R<sup>2</sup> value (AIC value for logistic regression).  All dependent and independent variables were reordered so that the higher the value, the higher the scale of the response. i.e. instead of 1 for Yes and 2 for No, we reordered it to 0 for No and 1 for Yes.          

<font color = red> Bilal: help to put in explanations on how to interpret the coefficients, and exp function. thanks!</font>
  
The 5 questions, their corresponding hypotheses, and their associated findings are summarised in the section below.  
  
***

## Executive summary of findings:
  
  
<u>Effects of Parent and child behaviour, on teen's use of social media</u>

The table below summarises the questions studied, the initial hypothesis, and findings from the data.  
  
Question                               |  Hypothesis   |  Findings
-------------------------------------  |  ------------------------------------- | -------------------------------------
1. Relationship between parents blocking their child’s phone usage and their child’s online behaviour on sexy/flirty pictures   |  If teens are rebellious, then the stricter the parent, the more the child wants to be liberal and may be more inclined to send flirty pictures | The regression results suggest that if parents took away their child’s cell phone or internet privileges as punishment, the teen is 169% more likely to send sexy or flirty pictures or videos of themselves. There is no statistically significant effect of other parent's strict behaviours: parent using parental controls to restrict child’s use of his/her cell phone, and limiting the amount of time or times of day when child can go online   
2.	Relationship on whether children self-censor their posts if they are friends with parents on social media   |   Teens’ whose parents are friends with them on social media will likely not post details of their relationship online  | There was no statiscally significant evidence to show that whether the parent was connected to their child on social media had an impact on child posting public affection for their significant other (proxy of whether child self-censors their posts). Upon adding more variables to the regression, the regression suggests that teens feeling pressure to only post content that makes them look good to others, were around 90% ("Yes, a little pressure") to 214% ("Yes, a lot pressure") more likely to post public affection towards his/her significant other. There is no significant statistical evidence to show that various teen's parent's behaviours (connecting with child on social media, being friends on Facebook, and checking child's social media profile) have an effect on teen's public affection behaviour.  This seems to suggest that teens are more influenced by their self-perception, rather than their parent's interventions, with respect to whether or not they post public affection towards his/her significant other.     
3.	Relationship between stalking behaviour of parent to child and stalking behaviour of child to his/her boyfriend/girlfriend |  If parents stalk teen, teen is more likely to inherit the stalking behaviour and stalk his/her boyfriend/girlfriend | It seemed that if parent monitors their child's location (parent's stalking behaviour), teens are around 190% more likely (at 90% confidence level) to access the phone of someone they were dating or used to date (child's stalking behaviour).  It seemed that if parent monitors their child's location (parent's stalking behaviour), teens are around 567% more likely (at 90% confidence level) to track the location of someone they were dating or used to date (child's stalking behaviour).  In both cases, parent monitoring child's location seemed correlated with both child's stalking behaviours (accessing phone and tracking GPS location).      
4. Relationship between the parent using internet / social media themselves vs. them talking to their child about inappropriate online behavior | Parents are likely to be in a better position to advise their children on online behavior if they themselves use internet or are on social media | ....    
5. How more likely are children to trust their significant others and not have the urge to constantly monitor their activities if their parents are more trusting of them? | Children are likely to have healthier relationships and not have insecurities regarding their significant others if they are trusted by their parents | ....    


***
## Details of the questions investigated, and findings
  
### Question 1  
 
Question: Relationship between parents blocking their child’s phone usage and their child’s online behaviour on sexy/flirty pictures   
  
*Hypothesis: The stricter the parent, the more the child wants to be liberal.*  
  
<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variable]*:  
KDATE2_G: Have you ever done any of these things to let someone know you were attracted to them or interested in them? Have you sent them sexy or flirty pictures or videos of yourself?  
1.Yes  
2.No  
  
*[Independent variables]*:  
P14_F: Have you ever used parental controls to restrict your child's use of his/her cell phone?  
1.Yes  
2.No  
3.Does Not Apply  

P13_D: Have you ever taken away your child's cell phone or internet privileges as punishment?  
1.Yes  
2.No  
3.Does Not Apply  

P13_E: Have you ever limited the amount of time or times of day when your child can go online?    
1.Yes  
2.No  
3.Does Not Apply  

<b> Data cleaning </b>  
  
Rows with invalid responses were removed by filling them with NA (e.g. if respondents were supposed to choose only options 1 or 2, but the data showed 3 or -1, these would be invalid responses).    
  
The order of the options were reversed, so that the higher number represents the "most" choice, and 0 for No or None. E.g. for if the question's original order of choices that respondents could choose from were:  
  1.Yes,  2.No  
The responses' order were re-ordered to:  
  0.No,  1. Yes  
  
For questions with options as Yes/No/Does not apply, for respondents who responded Does not apply, the data record was removed (by filling it with NA), and order No as 0 and Yes as  1.  
  

```{r, echo = FALSE}
data_specific <- data.frame(parent_controls_cell_phone = survey_data$P14_F, take_away_privileges = survey_data$P13_D, limit_time_online = survey_data$P13_E, y = survey_data$KDATE2_G)

# set NA to invalid responses
data_specific[ is.na(data_specific$parent_controls_cell_phone), ] <- NA
data_specific[ is.na(data_specific$take_away_privileges), ] <- NA
data_specific[ is.na(data_specific$limit_time_online), ] <- NA
data_specific[ is.na(data_specific$y), ] <- NA

# Remove data records where respondents replied "Does not apply"
# hence remove those >2 instead of >3
data_specific[ !is.na(data_specific$parent_controls_cell_phone) & (data_specific$parent_controls_cell_phone < 1 | data_specific$parent_controls_cell_phone > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$take_away_privileges) & (data_specific$take_away_privileges < 1 | data_specific$take_away_privileges > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$limit_time_online) & (data_specific$limit_time_online < 1 | data_specific$limit_time_online > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$y) & (data_specific$y < 1 | data_specific$y > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up

# only retain records that replied YES or NO
# convert from 1(YES)-2(NO)-3(does Not Apply)
#           to 0(NO)-1(YES)
data_specific$parent_controls_cell_phone <- abs(data_specific$parent_controls_cell_phone - 3) - 1
data_specific$take_away_privileges <- abs(data_specific$take_away_privileges - 3) - 1
data_specific$limit_time_online <- abs(data_specific$limit_time_online - 3) - 1
# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$y <- abs( data_specific$y - 3 ) - 1

cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])

# convert to factor for regression
data_specific$parent_controls_cell_phone <- factor(data_specific$parent_controls_cell_phone)
data_specific$take_away_privileges <- factor(data_specific$take_away_privileges)
data_specific$limit_time_online <- factor(data_specific$limit_time_online)

data_specific$age <- survey_data$Child_age

```

<b>Findings</b>  
    
The regression between whether teen sends flirty messages, and the strictness of parents: (i) by controlling cell phone, (ii) taking away privileges, (iii) limiting time spent online, and (iv) age, is shown below.    
  
```{r}
ml <- glm(y ~ parent_controls_cell_phone + take_away_privileges + limit_time_online + age, family = "binomial", data = na.omit(data_specific))

summary(ml)

exp(ml$coefficients)


```
  
The take_away_privileges variable is statistically significant with 99% confidence level.  
  
The regression results suggest that if parents took away their child’s cell phone or internet privileges as punishment, the teen is 169% more likely to send sexy or flirty pictures or videos of themselves. There is no statistically significant effect of parent using parental controls to restrict child’s use of his/her cell phone, and limiting the amount of time or times of day when  child can go online.  
  
Given that take_away_privileges was significant, the results suggest that parent's strictness behaviour did affect teen's behaviour on social media.  However, to be more conclusive, more aspects of parental strict behaviour, and more teen's possible rebellious behaviour, could be looked at if time permitted, and if more data was available.  For example, there was a lack of data on other proxies of rebellious behaviour or desire to be more liberal due to strictness of parent, besides sending flirty messages. Perhaps the survey could have included questions on whether the child had found alternative ways to access social media, such as using their friend's internet device or lie to parents that they were in school studying but were actually using a library computer to use social media.  With more data, the investigation could be more comprehensive to determine whether parents being strict had made the situation worse than if parents did not intervene.                 
      
  
***
  
### Question 2  
 
Question:  Relationship on whether children self-censor their posts if they are friends with parents on social media.    
  
*Hypothesis: Teens’ whose parents are friends with them on social media will likely not post details of their relationship online.*  
  
<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variable]*:  
KRSNS3_C: When you use social media do you ever tell your boyfriend, girlfriend or significant other how much you like them in a way that other people can see?  
1.Yes  
2.No  
  
*[Independent variables]*:  
P10: Are you connected with your child on any  social media sites?  
1.Yes  
2.No  
  
Similar data cleaning and manipulation operations were performed to get rid of invalid responses and to re-order values according from least to most.  
  
```{r, echo = FALSE}
data_specific <- data.frame(parent_connect_child = survey_data$P10, teen_public_affection = survey_data$KRSNS3_C)

# set NA to invalid responses
data_specific[ is.na(data_specific$parent_connect_child), ] <- NA
data_specific[ is.na(data_specific$teen_public_affection), ] <- NA

data_specific[ !is.na(data_specific$parent_connect_child) & (data_specific$parent_connect_child < 1 | data_specific$parent_connect_child > 3), ] <- NA  # needs the !is.na condition otherwise an error throws up
data_specific[ !is.na(data_specific$teen_public_affection) & (data_specific$teen_public_affection < 1 | data_specific$teen_public_affection > 3), ] <- NA  # needs the !is.na condition otherwise an error throws up

# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$parent_connect_child <- abs(data_specific$parent_connect_child - 3) - 1

data_specific$teen_public_affection <- abs(data_specific$teen_public_affection - 3) - 1

cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])

data_specific$age <- survey_data$Child_age


```

<b>Findings</b>  
    
```{r}

cor.test(data_specific$parent_connect_child, data_specific$teen_public_affection)

```

As the p-value is 0.2742, there is no statistically significant evidence to show that the two variables are correlated.


```{r}
# convert to factor for regression
data_specific$parent_connect_child <- factor(data_specific$parent_connect_child)

ml <- glm(teen_public_affection ~ parent_connect_child + age, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

The factor of parent connecting to child is not statistically significant.  
  
Further examination of the data:

```{r}
data_specific$teen_public_affection_factor <- factor(data_specific$teen_public_affection)

ggplot(data = na.omit(data_specific)) + geom_bar(aes(x = parent_connect_child, fill = teen_public_affection_factor), position = "dodge")

```

It seems that when the parent is connected to the child (option 1 / "Yes"), the proportion of teens who express their affection for their significant other publicly, is higher.  

A further a proportion test is done:  

```{r}
prob_table <- table(data_specific$parent_connect_child, data_specific$teen_public_affection)
# inverse the columns, as success is option 2 for teen_public_affection
prob_table <- cbind(prob_table[, 2], prob_table[, 1])
prop.test(prob_table)

```

The p-value = 0.3402, which suggests that there is no statistically significant evidence to show that the two proportions differ.
i.e. similar to the correlation tests, it suggests that the parent social media connection with the child, does not have significant effect on whether the teen shows public affection for significant other on social media.   

Given these intial results, more variables which may relate to the hypothesis, were added to the regression model:  
  
KFSNS1_E: In general, does social media make you feel pressure to only post content that makes you look good to others? 1.Yes, a lot,2.Yes, a little,3.No  
*To test if child's self perception is more strongly correlated to his/her behaviour regarding posting public affection for significant other*

P8:	Are you friends with your child on Facebook? 1.Yes, 2.No  
*To see if parent being friends on Facebook (compared to a more generic social media platform as asked by question P10), is a significant factor*
  
P13_C:  Have you ever checked your child's profile on a social networking site?  1(YES)-2(NO)-3(does Not Apply)  
*To see if parent checking child's profile is a significant factor. Perhaps if the child knows that his/her parent checks his/her profile, he/she will be more restrained in his/her post.*

```{r, echo = FALSE}
data_specific$feel_pressure <- survey_data$KFSNS1_E
data_specific[ is.na(data_specific$feel_pressure), ] <- NA

data_specific[ !is.na(data_specific$feel_pressure) & (data_specific$feel_pressure < 1 | data_specific$feel_pressure > 3), ] <- NA  # needs the !is.na condition otherwise an error throws up
# Change from 1.Yes, a lot,2.Yes, a little,3.No 
#         to 0.No, 1.Yes, a little, 2.Yes, a lot
data_specific$feel_pressure <- abs(data_specific$feel_pressure - 4) - 1 

data_specific$friends_facebook <- survey_data$P8
data_specific[ is.na(data_specific$friends_facebook), ] <- NA

data_specific[ !is.na(data_specific$friends_facebook) & (data_specific$friends_facebook < 1 | data_specific$friends_facebook > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$friends_facebook <- abs(data_specific$friends_facebook - 3) - 1

data_specific$check_child_profile <- survey_data$P13_C
data_specific[ is.na(data_specific$check_child_profile), ] <- NA

# Remove data records where respondents replied "Does not apply"
# hence remove >2 instead of >3
data_specific[ !is.na(data_specific$check_child_profile) & (data_specific$check_child_profile < 1 | data_specific$check_child_profile > 2), ] <- NA  # needs the !is.na condition otherwise an error throws up
# only retain records that replied YES or NO
# convert from 1(YES)-2(NO)-3(does Not Apply)
#           to 0(NO)-1(YES)
data_specific$check_child_profile <- abs(data_specific$check_child_profile - 3) - 1 

cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])


data_specific$feel_pressure <- factor(data_specific$feel_pressure)
data_specific$friends_facebook <- factor(data_specific$friends_facebook)
data_specific$check_child_profile <- factor(data_specific$check_child_profile)

```

```{r}
ml <- glm(teen_public_affection ~ parent_connect_child + age + feel_pressure + friends_facebook + check_child_profile, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

The regression suggests that teens feeling pressure to only post content that makes them look good to others, were around 90% ("Yes, a little pressure") to 214% ("Yes, a lot pressure") more likely to post public affection towards his/her significant other. There is no significant statistical evidence to show that various teen's parent's behaviours (connecting with child on social media, being friends on Facebook, and checking child's social media profile) have an effect on teen's public affection behaviour.  

This seems to suggest that teens are more influenced by their self-perception, rather than their parent's interventions, with respect to whether or not they post public affection towards his/her significant other.  
  
***
  
### Question 3  
 
Question:	Relationship between stalking behaviour of parent to child and stalking behaviour of child to his/her boyfriend/girlfriend.   
  
*Hypothesis: If parents stalk teen, teen is more likely to inherit the stalking behaviour and stalk his/her boyfriend/girlfriend*    
  
<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variables]*:  
KR13_C: Have you ever done any of the following to someone you were dating or used to date. Accessed their mobile phone or online accounts     
1.Yes  
2.No  
  
KR13_F: Have you ever done any of the following to someone you were dating or used to date. Downloaded a GPS or tracking program to their cell phone without them knowing      
1.Yes  
2.No  
  

*[Independent variables]*:  
P13_B: Have you ever checked which websites your child visited?   
1.Yes  
2.No  
3.Does Not Apply  
  
P14_G: Have you ever used monitoring tools to track your child's location with his/her cell phone?   
1.Yes  
2.No  
3.Does Not Apply  

P14_H: Have you ever looked at the phone call records or messages on your child's phone?   
1.Yes  
2.No  
3.Does Not Apply  
  
Similar data cleaning and manipulation operations were performed to get rid of invalid responses and to re-order values according from least to most.  
  
```{r, echo = FALSE}
data_specific <- data.frame(
  check_child_website = survey_data$P13_B, 
  monitor_child_location = survey_data$P14_G, 
  look_child_phone_records = survey_data$P14_H, 
  access_date_phone = survey_data$KR13_C, 
  track_date_loc = survey_data$KR13_F  )

# set NA to invalid responses
data_specific[ is.na(data_specific$check_child_website), ] <- NA
data_specific[ is.na(data_specific$monitor_child_location), ] <- NA
data_specific[ is.na(data_specific$look_child_phone_records), ] <- NA
data_specific[ is.na(data_specific$access_date_phone), ] <- NA
data_specific[ is.na(data_specific$track_date_loc), ] <- NA

# Remove data records where respondents replied "Does not apply"
# hence remove >2 instead of >3

data_specific[ !is.na(data_specific$check_child_website) & (data_specific$check_child_website < 1 | data_specific$check_child_website > 2), ] <- NA  

data_specific[ !is.na(data_specific$monitor_child_location) & (data_specific$monitor_child_location < 1 | data_specific$monitor_child_location > 2), ] <- NA  

data_specific[ !is.na(data_specific$look_child_phone_records) & (data_specific$look_child_phone_records < 1 | data_specific$look_child_phone_records > 2), ] <- NA  

data_specific[ !is.na(data_specific$access_date_phone) & (data_specific$access_date_phone < 1 | data_specific$access_date_phone > 2), ] <- NA  

data_specific[ !is.na(data_specific$track_date_loc) & (data_specific$track_date_loc < 1 | data_specific$track_date_loc > 2), ] <- NA  

# only retain records that replied YES or NO
# convert from 1(YES)-2(NO)-3(does Not Apply)
#           to 0(NO)-1(YES)

data_specific$check_child_website <- abs(data_specific$check_child_website - 3) - 1

data_specific$monitor_child_location <- abs(data_specific$monitor_child_location - 3) - 1

data_specific$look_child_phone_records <- abs(data_specific$look_child_phone_records - 3) - 1

# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
data_specific$access_date_phone <- abs(data_specific$access_date_phone - 3) - 1

data_specific$track_date_loc <- abs(data_specific$track_date_loc - 3) - 1

#data_specific$y <- data_specific$access_date_phone + data_specific$track_date_loc

data_specific$age <- survey_data$Child_age


cat('after data cleaning, number of valid data records for analysis is: ', dim(na.omit(data_specific))[1])

```

<b>Findings</b>  
    
```{r, echo = FALSE}
# convert to factor for regression
data_specific$check_child_website <- factor(data_specific$check_child_website)

data_specific$monitor_child_location <- factor(data_specific$monitor_child_location)

data_specific$look_child_phone_records <- factor(data_specific$look_child_phone_records)

data_specific$gender <- factor(survey_data$Child_gender, labels = c('Male','Female'))
```

```{r}
ml <- glm(access_date_phone ~ check_child_website + monitor_child_location + look_child_phone_records + gender + age, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

It seems that if parent monitors their child's location (parent's stalking behaviour), teens are around 190% more likely (at 90% confidence level) to access the phone of someone they were dating or used to date (child's stalking behaviour).   


```{r}
ml <- glm(track_date_loc ~ check_child_website + monitor_child_location + look_child_phone_records + gender + age, family = "binomial", data = na.omit(data_specific))
summary(ml)
exp(ml$coefficients)

```

It seems that if parent monitors their child's location (parent's stalking behaviour), teens are around 567% more likely (at 90% confidence level) to track the location of someone they were dating or used to date (child's stalking behaviour). It is interesting to note that the coefficient for this is much higher than the previous child stalking behaviour (accessing phone of significant other). This seems to indicate that a parent's behaviour would more strongly correlate to child's similar behaviour (both tracking location).    
  
In both cases, parent monitoring child's location seemed correlated with both child's stalking behaviours (accessing phone and tracking GPS location).  

Given that only one of the three parent's stalking behaviour was statistically significally, a possible alternate hypothesis would be that teen's stalking behaviour was influenced more by his/her own characteristics. Various other questions regarding the teen was explored, and the associated hypothesis (i.e. why these questions were studied), are as listed below. 

KR8: How frequently you expect to hear from your boyfriend/girlfriend/significant other in some way? 1.Hourly,2.Every few hours,3.Once a day,4.A few times a week,5.Once a week,6.Less often  

* Hypothesis: the more frequent, the more likely teen would stalk his/her date as the teen may be more emotionally needy. 

KR3_A: Have you ever searched for information online about someone you were currently dating or were interested in dating? 1(YES)-2(NO)

KR3_C: Have you ever searched for information online about someone you dated or hooked up with in the past? 1(YES)-2(NO)

* Hypothesis: These two questions are proxies of teen's desire to know more about their significant other that presumably the date(s) did not reveal, otherwise he/she would not be searching for more info. So if these questions were answered Yes, perhaps the more likely the teen would exhibit stalking behaviour.

KF15: Have you ever had a fight with any of your friends that started because of something that happened online or because of a text? 1(YES)-2(NO)

* Hypothesis: If the teen was emotionally less stable / unable to control emotions well, perhaps he/she may be more likely to stalk others (emotionally less controlled)

KFSNS1_B: In general, does social media make you feel worse about your own life because of what you see from other friends on social media? 1.Yes, a lot,2.Yes, a little,3.No

* Hypothesis: If teen feels worse, perhaps lower self-esteem may correlate to stalking behaviours (needs to always feel secure)

KFSNS1_E: In general, does social media make you feel pressure to only post content that makes you look good to others? 1.Yes, a lot,2.Yes, a little,3.No

* Hypothesis: Perhaps if one feel frequently pressured to look good, he/she would also frequently check if his significant other was doing things that 'betray' him/her and hence more likely to stalk.


```{r, echo = FALSE}

#KR8: How frequentlyyou expect to hear from your boyfriend/girlfriend/significant other in some way? 1.Hourly,2.Every few hours,3.Once a day,4.A few times a week,5.Once a week,6.Less often
data_specific$freq_expectn_SO <- survey_data$KR8
data_specific[ is.na(data_specific$freq_expectn_SO), ] <- NA
data_specific[ !is.na(data_specific$freq_expectn_SO) & (data_specific$freq_expectn_SO < 1 | data_specific$freq_expectn_SO > 6), ] <- NA  
data_specific$freq_expectn_SO <- abs( data_specific$freq_expectn_SO - 7)

data_specific$freq_expectn_SO <- factor(data_specific$freq_expectn_SO)

#KR3_A: Have you ever searched for information online about someone you were currently dating or were interested in dating? 1(YES)-2(NO)
data_specific$search_abt_date <- survey_data$KR3_A
data_specific[ is.na(data_specific$search_abt_date), ] <- NA
data_specific[ !is.na(data_specific$search_abt_date) & (data_specific$search_abt_date < 1 | data_specific$search_abt_date > 2), ] <- NA  
data_specific$search_abt_date <- abs( data_specific$search_abt_date - 3) - 1

data_specific$search_abt_date <- factor(data_specific$search_abt_date)

#KR3_C: Have you ever searched for information online about someone you dated or hooked up with in the past? 1(YES)-2(NO)
data_specific$search_abt_date_past <- survey_data$KR3_C
data_specific[ is.na(data_specific$search_abt_date_past), ] <- NA
data_specific[ !is.na(data_specific$search_abt_date_past) & (data_specific$search_abt_date_past < 1 | data_specific$search_abt_date_past > 2), ] <- NA  
data_specific$search_abt_date_past <- abs( data_specific$search_abt_date_past - 3) - 1

data_specific$search_abt_date_past <- factor(data_specific$search_abt_date_past)

#KF15: Have you ever had a fight with any of your friends that started because of something that happened online or because of a text? 1(YES)-2(NO)
data_specific$had_fight <- survey_data$KF15
data_specific[ is.na(data_specific$had_fight), ] <- NA
data_specific[ !is.na(data_specific$had_fight) & (data_specific$had_fight < 1 | data_specific$had_fight > 2), ] <- NA  
data_specific$had_fight <- abs( data_specific$had_fight - 3) - 1

data_specific$had_fight <- factor(data_specific$had_fight)


# KFSNS1_B: In general, does social media make you feel worse about your own life because of what you see from other friends on social media? 1.Yes, a lot,2.Yes, a little,3.No
data_specific$feel_worse <- survey_data$KFSNS1_B
data_specific[ is.na(data_specific$feel_worse), ] <- NA
data_specific[ !is.na(data_specific$feel_worse) & (data_specific$feel_worse < 1 | data_specific$feel_worse > 3), ] <- NA  
data_specific$feel_worse <- abs( data_specific$feel_worse - 4) - 1

data_specific$feel_worse <- factor(data_specific$feel_worse)

#KFSNS1_E: In general, does social media make you feel pressure to only post content that makes you look good to others? 1.Yes, a lot,2.Yes, a little,3.No
data_specific$feel_pressured <- survey_data$KFSNS1_E
data_specific[ is.na(data_specific$feel_pressured), ] <- NA
data_specific[ !is.na(data_specific$feel_pressured) & (data_specific$feel_pressured < 1 | data_specific$feel_pressured > 3), ] <- NA  
data_specific$feel_pressured <- abs( data_specific$feel_pressured - 4) - 1

data_specific$feel_pressured <- factor(data_specific$feel_pressured)


#ml <- glm(track_date_loc ~ check_child_website + monitor_child_location + look_child_phone_records + freq_expectn_SO + search_abt_date + search_abt_date_past + had_fight + feel_worse + feel_pressured + gender + age, family = "binomial", data = na.omit(data_specific))

ml <- glm(track_date_loc ~ check_child_website + monitor_child_location + look_child_phone_records + feel_worse + gender + age, family = "binomial", data = na.omit(data_specific))

summary(ml)
exp(ml$coefficients)

```

After testing for these various questions, only the "feel worse" question was statistically significant. It is interesting to see that feeling a lot worse (feel_worse_2) had a much higher coefficient. So perhaps if one had lower self esteem, he/she would be more likely to stalk his/her significant other. It is also interesting to note that adding the feel_worse variable made the parent monitor_child_location variable no longer statistically significant.  
  
****

### Question 4  

Question:	Relationship between the parent using internet / social media themselves vs. them talking to their child about inappropriate online behavior.  
    *Hypothesis: Parents are likely to be in a better position to advise their children on online behavior if they themselves use internet or are on social media*   


<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variable]*:  

parents_advice_score: This is a calculated column, which is basically the sum of P15_B and P15_C. It is a measure of how often a parent talks to his/her child about appropriate/inappropriate online behavior in general.  
Takes values between 2 (lowest) and 8(highest)   

P15_B: How often do you talk with your child about what is appropriate or inappropriateto share online?  
1.Never  
2.Rarely   
3.Occasionally  
4.Frequently  

P15_C: How often do you talk with your child about what is appropriate or inappropriatecontent for them to be viewing online?   
1.Never  
2.Rarely   
3.Occasionally  
4.Frequently  

*[Independent variables]*:  
P2_A: Do you ever use Facebook?  
1.Yes  
2.No  

P2_B: Do you ever use Twitter?  
1.Yes  
2.No  

P2_C: Do you ever access the internet on a cell phone, tablet or other mobile handheld device, at least occasionally?   
1.Yes  
2.No  

P2_D: Do you ever use some other social media site?    
1.Yes  
2.No  

  
<b> Data cleaning </b>  
  
Invalid responses were removed by filling them with NA (e.g. if respondents were supposed to choose only options 1 or 2, but the data showed 3 or -1, these would be invalid responses).    
  
The numeric coding was changed such that 0 represented a 'No' and 1 a 'Yes'. E.g. if the question's original order of choices that respondents could choose from were:  
  1.Yes,  2.No  
The responses' order were re-ordered to:  
  0.No,  1. Yes  
  
For questions with options Yes/No/Does not apply, 'Does not apply' was treated as an NA.  

```{r, echo = FALSE}
local_data4 <- data.frame(use_facebook = survey_data$P2_A, use_twitter = survey_data$P2_B, use_internet = survey_data$P2_C, use_other_social_media = survey_data$P2_D,  P15_B = survey_data$P15_B, P15_C = survey_data$P15_C, age = survey_data$Child_age, gender = survey_data$Child_gender)


# Replace everything except 1 and 2 with NA
local_data4$use_facebook[ !is.na(local_data4$use_facebook) & (local_data4$use_facebook < 1 | local_data4$use_facebook > 2)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data4$use_twitter[ !is.na(local_data4$use_twitter) & (local_data4$use_twitter < 1 | local_data4$use_twitter > 2)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data4$use_internet[ !is.na(local_data4$use_internet) & (local_data4$use_internet < 1 | local_data4$use_internet > 2)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data4$use_other_social_media[ !is.na(local_data4$use_other_social_media) & (local_data4$use_other_social_media < 1 | local_data4$use_other_social_media > 2)] <- NA  # needs the !is.na condition otherwise an error throws up


# Replace everything except 1 to 4 with NA
local_data4$P15_B[ !is.na(local_data4$P15_B) & (local_data4$P15_B < 1 | local_data4$P15_B > 4)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data4$P15_C[ !is.na(local_data4$P15_C) & (local_data4$P15_C < 1 | local_data4$P15_C > 4)] <- NA  # needs the !is.na condition otherwise an error throws up

#Calculated Variable based on P15_B and P15_C
local_data4$parents_advice_score = 2*rowMeans(local_data4[, c("P15_B", "P15_C")], na.rm = TRUE)


# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
local_data4$use_facebook <- abs(local_data4$use_facebook - 2)
local_data4$use_twitter <- abs(local_data4$use_twitter - 2)
local_data4$use_internet <- abs(local_data4$use_internet - 2)
local_data4$use_other_social_media <- abs(local_data4$use_other_social_media - 2)

# convert from 1(Male)-2(Female)
#           to 0(Female)-1(Male)
local_data4$gender <- abs(local_data4$gender - 2)


cat('After data cleaning, the number of valid data records for analysis is: ', dim(na.omit(local_data4))[1])


```


Correlation Matrix:

```{r}  
cor(local_data4[,"parents_advice_score"], local_data4[,c("parents_advice_score","use_facebook", "use_twitter", "use_other_social_media", "use_internet")], use = "pairwise.complete.obs")

```

Correlation tests were run on each of these and only the correlation of use_internet came out to be significantly different from 0 at 5% confidence level. Its results are shown below: 

```{r}
cor.test(local_data4$parents_advice_score, local_data4$use_internet)
```


```{r, echo = FALSE} 

# convert binomial variables to factors for plotting etc.
local_data4$gender <- factor(local_data4$gender, levels = c('0', '1'), labels = c('Female','Male'))

local_data4$use_facebook <- factor(local_data4$use_facebook, levels = c('0', '1'), labels = c('No','Yes'))

local_data4$use_twitter <- factor(local_data4$use_twitter, levels = c('0', '1'), labels = c('No','Yes'))

local_data4$use_internet <- factor(local_data4$use_internet, levels = c('0', '1'), labels = c('No','Yes'))

local_data4$use_other_social_media <- factor(local_data4$use_other_social_media, levels = c('0', '1'), labels = c('No','Yes'))

```



Plotting

```{r}

g1 <- ggplot(data = na.omit(local_data4[,c("gender","parents_advice_score")])) + geom_bar(aes(x = gender, fill = factor(parents_advice_score)), position = "fill") + scale_y_continuous(labels=percent)

g2 <- ggplot(data = na.omit(local_data4[,c("age","parents_advice_score")])) + geom_bar(aes(x = age, fill = factor(parents_advice_score)), position = "fill") + scale_y_continuous(labels=percent)

grid.arrange(g1, g2, ncol = 1)

```


Mean test for gender:


```{r}

t.test(x = local_data4$parents_advice_score[local_data4$gender == "Male"], y = local_data4$parents_advice_score[local_data4$gender == "Female"], alternative = "less")

```


Mean test for age:

```{r}

t.test(local_data4$parents_advice_score[local_data4$age == 13 | local_data4$age == 14 | local_data4$age == 15], local_data4$parents_advice_score[local_data4$age == 16 | local_data4$age == 17], alternative = "greater")

```

Divided into two clusters for testing whether there is a difference in means. 13-15 and 16-17.


Initial Regression Model:

```{r}
#Initial Model
m4 <- lm(parents_advice_score ~ use_facebook + use_twitter + use_internet + use_other_social_media + age + gender, data = local_data4)

summary(m4)
```


Final Model:
```{r}
m4 <- lm(parents_advice_score ~ use_facebook + use_internet + age + gender, data = local_data4)


summary(m4)
```

Only use_internet and age are significant at 5%. Parents talk less as children grow older.

Facebook usage and Gender are close to being significant at 10% level. More data might make these two variables significant in this model as well.

***

### Question 5

Question: How more likely are children to trust their significant others and not have the urge to constantly monitor their activities if their parents are more trusting of them?  
    *Hypothesis: Children are likely to have healthier relationships and not have insecurities regarding their significant others if they are trusted by their parents*  

<b>Background info - data cleaning and manipulation</b>

For this question, the relevant dataset questions are:

*[Dependent variable]*:  
KRSNS3_A: When you use social media do you ever keep track of where your boyfriend, girlfriend or significant other is or what they are doing? 
1.Yes  
2.No  
  
*[Independent variables]*:  
P13_A: Have you ever used parental controls or other technological means of blocking, filtering or monitoring your child's online activities?  
1.Yes  
2.No  
3.Does Not Apply  

P13_B: Have you ever checked which websites your child visited?  
1.Yes  
2.No  
3.Does Not Apply  

P14_G: Have you ever used monitoring tools to track your child's location with his/her cell phone?   
1.Yes  
2.No  
3.Does Not Apply  

P14_H: Have you ever looked at the phone call records or messages on your child's phone?    
1.Yes  
2.No  
3.Does Not Apply  

  
<b> Data cleaning </b>  
  
Similar data cleaning and manipulation operations were performed to get rid of invalid responses and to re-order values according from least to most.  

```{r, echo = FALSE}
local_data5 <- data.frame(used_parental_controls = survey_data$P13_A, checked_websites_visited = survey_data$P13_B, tracked_childs_location = survey_data$P14_G, tracked_calls_and_messages = survey_data$P14_H,  kid_tracking_significant_others_activity = survey_data$KRSNS3_A, age = survey_data$Child_age, gender = survey_data$Child_gender)

# set NA to invalid responses
#local_data5[ is.na(local_data5$used_parental_controls), ] <- NA
#local_data5[ is.na(local_data5$checked_websites_visited), ] <- NA
#local_data5[ is.na(local_data5$tracked_childs_location), ] <- NA
#local_data5[ is.na(local_data5$tracked_calls_and_messages), ] <- NA
#local_data5[ is.na(local_data5$kid_tracking_significant_others_activity), ] <- NA

# Replace values where respondents replied "Does not apply" and everything except 1 and 2 with NA
local_data5$used_parental_controls[ !is.na(local_data5$used_parental_controls) & (local_data5$used_parental_controls < 1 | local_data5$used_parental_controls > 2)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data5$used_parental_controls[ !is.na(local_data5$checked_websites_visited) & (local_data5$checked_websites_visited < 1 | local_data5$checked_websites_visited > 2)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data5$used_parental_controls[ !is.na(local_data5$tracked_childs_location) & (local_data5$tracked_childs_location < 1 | local_data5$tracked_childs_location > 2)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data5$used_parental_controls[ !is.na(local_data5$tracked_calls_and_messages) & (local_data5$tracked_calls_and_messages < 1 | local_data5$tracked_calls_and_messages > 2)] <- NA  # needs the !is.na condition otherwise an error throws up

local_data5$used_parental_controls[ !is.na(local_data5$kid_tracking_significant_others_activity) & (local_data5$kid_tracking_significant_others_activity < 1 | local_data5$kid_tracking_significant_others_activity > 2)] <- NA  # needs the !is.na condition otherwise an error throws up


# convert from 1(YES)-2(NO)
#           to 0(NO)-1(YES)
local_data5$used_parental_controls <- abs(local_data5$used_parental_controls - 2)
local_data5$checked_websites_visited <- abs(local_data5$checked_websites_visited - 2)
local_data5$tracked_childs_location <- abs(local_data5$tracked_childs_location - 2)
local_data5$tracked_calls_and_messages <- abs(local_data5$tracked_calls_and_messages - 2)
local_data5$kid_tracking_significant_others_activity <- abs(local_data5$kid_tracking_significant_others_activity - 2)

# convert from 1(Male)-2(Female)
#           to 0(Female)-1(Male)
local_data5$gender <- abs(local_data5$gender - 2)


cat('After data cleaning, the number of valid data records for analysis is: ', dim(na.omit(local_data5))[1])

```


Correlation Matrix:

```{r}
cor(local_data5[,"kid_tracking_significant_others_activity"], local_data5[,c("kid_tracking_significant_others_activity","used_parental_controls", "checked_websites_visited", "tracked_childs_location", "tracked_calls_and_messages")], use = "pairwise.complete.obs")


```

Correlation tests were run to see if there is significant statistical evidence that the correlation is different from 0 for any of these variables. Only tracked_childs_location came out to be different from 0 and its results are shown below:

```{r}
cor.test(local_data5$kid_tracking_significant_others_activity, local_data5$tracked_childs_location)
```


```{r, echo = FALSE}

# convert binomial variables to factors for plotting etc.
local_data5$gender <- factor(local_data5$gender, levels = c('0', '1'), labels = c('Female','Male'))

local_data5$used_parental_controls <- factor(local_data5$used_parental_controls, levels = c('0', '1'), labels = c('No','Yes'))

local_data5$checked_websites_visited <- factor(local_data5$checked_websites_visited, levels = c('0', '1'), labels = c('No','Yes'))

local_data5$tracked_childs_location <- factor(local_data5$tracked_childs_location, levels = c('0', '1'), labels = c('No','Yes'))

local_data5$tracked_calls_and_messages <- factor(local_data5$tracked_calls_and_messages, levels = c('0', '1'), labels = c('No','Yes'))

local_data5$kid_tracking_significant_others_activity <- factor(local_data5$kid_tracking_significant_others_activity, levels = c('0', '1'), labels = c('No','Yes'))

```



Plotting y

```{r}

g1 <- ggplot(data = na.omit(local_data5)) + geom_bar(aes(x = gender, fill = kid_tracking_significant_others_activity), position = "dodge")

g2 <- ggplot(data = na.omit(local_data5)) + geom_bar(aes(x = gender, fill = kid_tracking_significant_others_activity), position = "fill") + scale_y_continuous(labels=percent)


grid.arrange(g1, g2, ncol = 1)

```

Plotting x

```{r}

g3 <- ggplot(data = na.omit(local_data5)) + geom_bar(aes(x = gender, fill = used_parental_controls), position = "fill") + scale_y_continuous(labels=percent)

g4 <- ggplot(data = na.omit(local_data5)) + geom_bar(aes(x = gender, fill = checked_websites_visited), position = "fill") + scale_y_continuous(labels=percent)

g5 <- ggplot(data = na.omit(local_data5)) + geom_bar(aes(x = gender, fill = tracked_childs_location), position = "fill") + scale_y_continuous(labels=percent)

g6 <- ggplot(data = na.omit(local_data5)) + geom_bar(aes(x = gender, fill = tracked_calls_and_messages), position = "fill") + scale_y_continuous(labels=percent)

grid.arrange(g3, g4, g5, g6, ncol = 2)

```


Prop test:


```{r}

prop.test(table(local_data5$kid_tracking_significant_others_activity, local_data5$gender), alternative = "less")
```

Reveals that males are less likely to keep track of their significant other on social media. which might go against our general perception, which usually is that females tend to trust their partners more. The behavior on social mediaappears to be otherwise howevver. It may also mean however that females tend to give more importance to their relationships than their counterparts in general, whereas men may give more time to other things n social media.

Regression:

```{r}
#Initial Model
m5 <- glm(kid_tracking_significant_others_activity ~ used_parental_controls + checked_websites_visited + tracked_childs_location + tracked_calls_and_messages + age + gender, data = local_data5, family = "binomial")

```


```{r}
#Final Model after trying different combinations
m5 <- glm(kid_tracking_significant_others_activity ~ checked_websites_visited + tracked_childs_location + age + gender, data = local_data5, family = "binomial")

summary(m5)

exp (m5$coefficients)
```

tracked child location is coming out significant at 1% and gender at 5%.

However, it is important to note here that The number of people who use monitoring tools to track their child's location is not particularly big in this survey, as compared to the other ways used by parents to track their child. So further research would be needed to see if the effect holds in relatively larger samples.


***


## Limitations

The analysis was limited to dependent variables with binary Yes/No oprtions. Ideally, dependent variables with more than 2 options should be considered as well. Perhaps polr function could be used, but there was insufficient time to investigate and understand this further.  

<font color = red>Bilal to add on </font>  
  
***

## Conclusion

<font color = red> Bilal to add on </font>

## Possible future improvements

A more robust analysis on the trends of the effect of parents' behaviours on teen's behaviours with regard to social media usage (e.g. stalking behaviour, defiance / urge to be liberalised etc) could be conducted if we had more data. Perhaps more questions could be asked to parent and teen in this aspect, to further tease out these possible relationships between parent and teen. More historical data, not just for one year, could be collated and analysed to discover if there were any trends, or whether these parent-child relationships were consistent over time, for 13-17 year old teenage groups across cohorts. It would also be interesting if the survey was conducted for older children, beyond 17 year olds, to test if certain hypotheses or relationships between parent and child persist beyond these ages. For example, if data suggest that parent's stalking behaviour positively correlate with teen's stalking behaviour, it would be interesting to investigate whether the teen's stalking behaviour persist even when he/she is 25 years old. If so, it would suggest that parents should be educated to let them realise what appropriate interventions they should be making, and sometimes well-intended interventions, if executed in the wrong way, could perhaps lead to more permanent adverse impact on the teen.         

<font color = red>{ideas on how we can improve the analysis - e.g. if we had more data on blah blah}</font>
